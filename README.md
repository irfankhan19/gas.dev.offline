ant-template-for-gas
====================

apache ant build.xml template for GAS


● 前提となるツールについて

apache ant

google closure tools
- closure-compiler
- gjslint

上記を用意した後、build.xml を ant へ与えてください。


● できること

１）ソースファイルの連結

- 手元でコードを書いていると、GASのエディタに（このあいだまでは）コピペするしか手がなかったので、複数ファイルでは面倒でした。
- なので、ひとつにまとめます。

２）本番用と試験用のつくりわけ

- unit testのために、.spec.js ファイルを連結したものと、実運用のために .spec.js のないものをコマンドひとつでつくりわけます。
- ant compile / ant compile-utest

３）Closure-compiler へのファイルの渡し方を簡易に

だいぶ探したのですが、ant から closure-compiler を便利に使いやすくする build.xml が探してもみつかりませんでした。
それがこれをつくった動機なのですが、そこそこ使いやすくなっていると思います。

closure-compiler へ渡すファイルにはいくつかの種類があります。

- ソースコード：　　本来のソースコード。静的解析をし、マージしたい。

- ライブラリファイル：　　マージしたいが、静的解析の対象からは外しておきたい（警告されても困るため）

- externファイル：　　GASのSpredsheet APIなど、外部参照を定義するためのファイル

上記はまた、本番用か試験用かによって、対象となるファイルが変化します。

それらの組み合わせを、簡易に扱えるようにしてあります。
具体的な説明は省きますが、build.xml のなかをみると、やりたいことがだいたい伝わると思います。

４）圧縮と非圧縮

closure-compilerは、最終コードを圧縮します。
ですが、GASでのデバッグ時には、コメントも含めて非削除・非圧縮のほうが便利です。

ので、closure compilerによる圧縮コードと、単に連結しただけの非圧縮コードとを出力します。


● 今後の予定

少し使ってみて、安定させようと思っています。
安定して、これでよさそう、となったら、真面目にドキュメントつくります。

あと、jsdocのツール、どれをどう使うのがいいか、まだ試せていません。
これも少し時間をかけていじってみます。


● 希望的妄想

自動デプロイ（サントリーさんに期待）

自動テスト



以上、雑メモですが、取り急ぎ。
