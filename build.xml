<?xml version="1.0" encoding="UTF-8" ?>
<project name="ant-template" default="usage" basedir=".">
	<description>
		simple example build file
	</description>

	<!-- set global properties for this build -->
	<property name="src_dir" 	location="./src" />
	<property name="tmp_dir" 	location="./tmp" />
	<property name="out_dir" 	location="./gs" />
	<property name="yuidoc_dir" 	location="./yuidoc" />
	<property name="jsdoc2_dir" 	location="./jsdoc2" />
	<property name="jsdoc3_dir" 	location="./jsdoc3" />
	<property name="tool_path"	location="/usr/local/closure-compiler" />

	<taskdef name="jscomp"
			 classname="com.google.javascript.jscomp.ant.CompileTask"
			 classpath="/usr/local/closure-compiler/compiler.jar"  />

	<target name="usage">
		<echo message="ant -projecthelp" />
	</target>

	<target name="init" depends="clean" description="clean and create directories.">
		<!-- Delete the ${tmp_dir} and ${out_dir} directory trees -->
		<delete dir="${tmp_dir}"/>
		<mkdir  dir="${tmp_dir}"/>

		<!-- Create the time stamp -->
		<tstamp />
	</target>

	<target name="lint" depends="init" description="gjslint">
		<mkdir dir="${tmp_dir}"/>
		<exec executable="gjslint" failonerror="true" output="${tmp_dir}/lint_error">
			<arg line="${src_dir}/*.js" />
		</exec>
	</target>

	<target name="compile1" depends="init" description="closure copiler">
		<delete dir="${out_dir}"/>
		<mkdir  dir="${out_dir}"/>

		<java jar="${tool_path}/compiler.jar" fork="true" failonerror="true"
			output="${out_dir}/ant-build-xml.gs" error="${tmp_dir}/compile_error">
			<arg line="--warning_level VERBOSE" />
			<arg prefix="--js" />
			<arg file="${src_dir}/main.js" />
			<arg file="${src_dir}/sub.js" />
		</java>
	</target>


	<target name="compile2" depends="init" description="closure copiler">
		<delete dir="${out_dir}"/>
		<mkdir  dir="${out_dir}"/>

		<jscomp compilationLevel="simple" warning="verbose"
			debug="false" output="${out_dir}/file.js">

			<!-- externs dir="${basedir}/src">
			<file name="extern.js"/>
			</externs -->

			<sources dir="${basedir}/src">
				<file name="main.js"/>
				<file name="sub.js"/>
			</sources>

			<!-- sources dir="${basedir}/other">
			<file name="simple3.js"/>
			</sources -->
		</jscomp>
    </target>

    <!-- JsDoc commands -->

	<target name="jsdoc2" description="jsdoc-toolkit">
		<delete dir="${jsdoc2_dir}"/>
		<mkdir  dir="${jsdoc2_dir}"/>

		<exec executable="jsdoc" failonerror="true" output="${tmp_dir}/jsdoc_error">
			<arg line="${src_dir} -d ${jsdoc2_dir}" />
		</exec>
	</target>

	<target name="jsdoc3" description="jsdoc3">
		<delete dir="${jsdoc3_dir}"/>
		<mkdir  dir="${jsdoc3_dir}"/>

		<exec executable="jsdoc" failonerror="true" output="${tmp_dir}/jsdoc_error">
			<arg line="${src_dir} -d ${jsdoc3_dir}" />
		</exec>
	</target>

	<target name="yuidoc" description="yuidoc">
		<delete dir="${yuidoc_dir}"/>
		<mkdir  dir="${yuidoc_dir}"/>

		<exec executable="yuidoc" failonerror="true" output="${tmp_dir}/yuidoc_error">
			<arg line="${src_dir} -o ${yuidoc_dir}" />
		</exec>
	</target>

	<!-- clean up project -->
	<target name="clean" description="clean up temp files">
		<!-- Create the time stamp -->
		<tstamp/>

		<!-- Delete the ${tmp_dir} and ${out_dir} directory trees -->
		<delete dir="${tmp_dir}"/>
		<delete dir="${out_dir}"/>
		<delete dir="${jsdoc2_dir}"/>
		<delete dir="${jsdoc3_dir}"/>
		<delete dir="${yuidoc_dir}"/>
	</target>

</project>
